<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="author"
    content="David Santiago Crispoca Taborda, Sebastian Guzman Castiblanco, Yoann Esteban Jacome Garcia, Maria Alejandra Suarez Cuesta.">
  <meta name="description"
    content="Proyecto Tecnologías del internet MUL B 2025-01, pagina web creada con HTML, CSS Y JavaScript.">
  <title>Floristería Las Acacias</title>
  <link rel="stylesheet" href="styles.css" />
</head>

<body>
  <!-- Header -->
  <header class="header">
    <button class="cart-button">🛒</button>
    <button class="login-button">👤</button>
    <div class="logo">
      <a href="index.html">
        <img src="imagenes/logo2.jpg" alt="Logo de Floristería Las Acacias" />
      </a>
    </div>
    <div class="search-box">
      <input type="text" id="search-input" placeholder="Buscar productos..." />
      <div id="search-results" class="search-results"></div>
    </div>
  </header>

  <!-- Navegación -->
  <nav class="navbar">
    <ul>
      <li><a href="#inicio">Inicio</a></li>
      <li><a href="productos.html">Productos</a></li>
      <li><a href="quienes-somos.html">Quienes Somos</a></li>
      <li><a href="preguntas-frecuentes.html">Preguntas Frecuentes</a></li>
      <li id="dynamic-nav-item" style="display: none;"> <!-- Enlace dinamico depende del rol -->
        <a id="nav-link" href="#"></a>
      </li>
    </ul>
  </nav>

  <!-- Productos destacados -->
  <h1 class="featured-title">Productos destacados</h1>

  <!-- Carrusel de Imágenes -->
  <section id="inicio" class="carousel">
    <div class="carousel-inner">
      <div class="carousel-item flor-clickeable">
        <img src="imagenes/ramo-1.jpeg" alt="Flor 1" />
      </div>
      <div class="carousel-item flor-clickeable">
        <img src="imagenes/manojo-2.jpeg" alt="Flor 2" />
      </div>
      <div class="carousel-item flor-clickeable">
        <img src="imagenes/ramo-4.jpg" alt="Flor 3" />
      </div>
      <div class="carousel-item flor-clickeable">
        <img src="imagenes/manojo-5.jpeg" alt="Flor 4" />
      </div>
      <div class="carousel-item flor-clickeable">
        <img src="imagenes/ramo-6.jpg" alt="Flor 5" />
      </div>
      <div class="carousel-item flor-clickeable">
        <img src="imagenes/manojo-3.jpeg" alt="Flor 6" />
      </div>
      <div class="carousel-item flor-clickeable">
        <img src="imagenes/ramo-6.jpg" alt="Flor 7" />
      </div>
      <!-- Nuevas flores -->
      <div class="carousel-item flor-clickeable">
        <img src="imagenes/manojo-5.jpeg" alt="Flor 8" />
      </div>
      <div class="carousel-item flor-clickeable">
        <img src="imagenes/manojo-2.jpeg" alt="Flor 9" />
      </div>
    </div>
    <button class="carousel-control prev">&#10094;</button>
    <button class="carousel-control next">&#10095;</button>
  </section>

  <!-- Productos de temporada -->
  <h1 class="seasonal-title">Productos de temporada</h1>
  <section class="seasonal-grid">
    <div class="seasonal-item flor-clickeable">
      <img src="imagenes/ramo-1.jpeg" alt="Flor de temporada 1" />
    </div>
    <div class="seasonal-item flor-clickeable">
      <img src="imagenes/ramo-2.png" alt="Flor de temporada 2" />
    </div>
    <div class="seasonal-item flor-clickeable">
      <img src="imagenes/ramo-3.jpg" alt="Flor de temporada 3" />
    </div>
    <div class="seasonal-item flor-clickeable">
      <img src="imagenes/ramo-4.jpg" alt="Flor de temporada 4" />
    </div>
  </section>

  <!--Productos de temporada-->
  <h1 class="seasonal-title">Productos Reciente</h1>
  <section class="seasonal-grid">
    <div class="seasonal-item flor-clickeable">
      <img src="imagenes/Ramo9.jpeg" alt="Flor reciente 1" />
    </div>
    <div class="seasonal-item flor-clickeable">
      <img src="imagenes/Ramo10.jpeg" alt="Flor reciente 2" />
    </div>
    <div class="seasonal-item flor-clickeable">
      <img src="imagenes/Manojo10.jpeg" alt="Flor reciente 3" />
    </div>
    <div class="seasonal-item flor-clickeable">
      <img src="imagenes/Manojo11.jpeg" alt="Flor reciente 4" />
    </div>
  </section>

  <!--Modal de flores-->
  <div id="modal" class="modal">
    <div class="modal-contenido">
      <span class="cerrar-modal">&times;</span>
      <h2 id="modal-titulo">Nombre de la Flor</h2>
      <img id="modal-imagen" src="" alt="Flor" class="modal-imagen" />
      <p id="modal-descripcion">Descripción de la flor.</p>
      <p id="modal-precio">Precio: $XX.XXX</p>
      <div class="cantidad-agregar">
        <label for="cantidad">Cantidad:</label>
        <input type="number" id="cantidad" min="1" value="1" />
        <button id="agregar-carrito">Agregar al carrito</button>
      </div>
      <div class="mensaje">
        <label for="mensaje-flor">Mensaje para la flor:</label>
        <textarea id="mensaje-flor" rows="4" placeholder="Escribe tu mensaje aquí..."></textarea>
      </div>
      <div class="accesorios">
        <label>Accesorios:</label>
        <select id="accesorios">
          <option value="ninguno">Ninguno</option>
          <option value="oso">Oso de peluche (+$10.000)</option>
          <option value="globo">Globo temático (+$5.000)</option>
          <option value="chocolate">Chocolate (+$7.000)</option>
          <option value="corona">Corona (+$8.000)</option>
        </select>
      </div>
    </div>
  </div>

  <!-- Aviso de Cookies -->
  <div id="cookie-notice" class="cookie-notice">
    <p>Este sitio web utiliza cookies para mejorar tu experiencia.</p>
    <button id="accept-cookies" class="cookie-button">Aceptar</button>
  </div>

  <!-- Carrito de compras -->
  <div id="carrito-modal" class="carrito-modal">
    <div class="carrito-header">
      <h2>Tu Carrito</h2>
      <span class="cerrar-carrito">&times;</span>
    </div>
    <div id="carrito-items"></div>
    <div class="carrito-total">Total: $<span id="carrito-total">0</span></div>
    <div class="carrito-botones">
      <button class="vaciar-carrito" id="vaciar-carrito">
        Vaciar Carrito
      </button>
      <a href="pagos.html" class="pagar-carrito">Ir a pagar</a>
    </div>
  </div>

  <div class="confirmacion-agregado" id="confirmacion-agregado">
    Producto añadido al carrito!
  </div>

  <!-- Modal de Login -->
  <div id="login-modal" class="modal">
    <div class="modal-contenido">
      <span class="cerrar-login">&times;</span>
      <div class="login-tabs">
        <button class="tab-link active" data-tab="login">Iniciar Sesión</button>
        <button class="tab-link" data-tab="registro">Registrarse</button>
      </div>

      <!-- Formulario de Login -->
      <div id="login" class="tab-content active">
        <form id="login-form">
          <div class="form-group">
            <label for="username">Correo:</label>
            <input type="text" id="correo" name="correo" required> 
          </div>

          <div class="form-group">
            <label for="password">Contraseña:</label>
            <input type="password" id="password" name="password" required> 
          </div>

          <button type="submit" class="login-submit">Ingresar</button>
        </form>
      </div>

      <!-- Formulario de Registro Vendedor -->
      <div id="registro" class="tab-content">
        <form id="registro-form">
          <div class="form-group">
            <label for="reg-username">nombre:</label>
            <input type="text" id="reg-username" required>
          </div>

          <div class="form-group">
            <label for="reg-password">contraseña:</label>
            <input type="password" id="reg-password" required>
          </div>

          <div class="form-group">
            <label for="reg-email">correo:</label>
            <input type="email" id="reg-email" required>
          </div>
          <button type="submit" class="login-submit">Registrarse como Vendedor</button>
        </form>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <footer>
    <div class="footer-container">
      <div class="footer-section">
        <h3>Contáctanos</h3>
        <p><i class="fab fa-whatsapp"></i> +57 321 9694834</p>
        <p>
          <i class="fa-solid fa-envelope"></i> lasacaciasfloristeria@gmail.com
        </p>
      </div>

      <!--Formas de pago-->
      <div class="footer-section">
        <h3>Formas de pago</h3>
        <img src="imagenes/NequiLogo.png" alt="Nequi" style="width: 60px" />
      </div>

      <!--Redes-->
      <div class="footer-section">
        <h3>Redes</h3>
        <p>
          <a href="https://www.facebook.com/share/1Ahi9w2jai/" target="_blank" rel="noopener noreferrer">
            <img src="imagenes/Facebook.png" alt="Facebook" class="social-btn" />
          </a>
          <a href="https://www.instagram.com/lasacaciasflores/" target="_blank" rel="noopener noreferrer">
            <img src="imagenes/instagram.png" alt="Instagram" class="social-btn" />
          </a>
        </p>
      </div>
    </div>
    <div class="footer-copy">
      <p>© 2025 Floristería Las Acacias</p>
    </div>
  </footer>

  <!-- Script Interno -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      // -------------------- CARRUSEL --------------------
      const carouselInner = document.querySelector(".carousel-inner");
      const items = document.querySelectorAll(".carousel-item");
      const visibleCount = 5;
      let currentIndex = 0;
      const itemWidth = 100 / visibleCount;

      items.forEach((item) => (item.style.flex = `0 0 ${itemWidth}%`));
      const totalItems = items.length;

      function updateControls() {
        const prevButton = document.querySelector(".carousel-control.prev");
        const nextButton = document.querySelector(".carousel-control.next");
        prevButton.disabled = currentIndex === 0;
        nextButton.disabled = currentIndex >= totalItems - visibleCount;
      }

      function moveCarousel(direction) {
        if (direction === "next" && currentIndex < totalItems - visibleCount)
          currentIndex++;
        if (direction === "prev" && currentIndex > 0) currentIndex--;

        carouselInner.style.transform = `translateX(-${currentIndex * itemWidth
          }%)`;
        updateControls();
      }

      document
        .querySelector(".carousel-control.prev")
        .addEventListener("click", () => moveCarousel("prev"));
      document
        .querySelector(".carousel-control.next")
        .addEventListener("click", () => moveCarousel("next"));
      updateControls();

      // -------------------- COOKIES --------------------
      // ---- Funciones para crear y leer cookies ----
      function setCookie(name, value, days) {
        const d = new Date();
        d.setTime(d.getTime() + days * 24 * 60 * 60 * 1000);
        document.cookie = `${name}=${value};expires=${d.toUTCString()};path=/`;
      }

      function getCookie(name) {
        const nameEQ = name + "=";
        return document.cookie
          .split(';')
          .map(c => c.trim())
          .find(c => c.startsWith(nameEQ))
          ?.substring(nameEQ.length) || null;
      }

      // ---- Lógica del banner ----
      const cookieNotice = document.getElementById("cookie-notice");
      const acceptBtn = document.getElementById("accept-cookies");

      if (acceptBtn) {
        acceptBtn.addEventListener("click", () => {
          setCookie("cookiesAceptada", "true", 7);    // caduca en 7 días
          cookieNotice.style.display = "none";
          console.log("Cookies aceptadas (guardado en cookie)");
        });

        // Al cargar la página, ocultar si ya está aceptado
        if (getCookie("cookiesAceptada") === "true") {
          cookieNotice.style.display = "none";
          console.log("Cookies ya aceptadas");
        }
      }

      // -------------------- DATOS FLORES --------------------
      const datosFlores = [
        {
          nombre: "Ramo Rosas Rojas",
          imagen: "imagenes/ramo-1.jpeg",
          descripcion:
            "Un hermoso ramo de rosas rojas, perfecto para cualquier ocasión.",
          precio: "$80.000",
        },
        {
          nombre: "Manojo Variado",
          imagen: "imagenes/manojo-2.jpeg",
          descripcion:
            "Manojo de Rosas variadas, ideal para expresar amor y pureza.",
          precio: "$30.000",
        },
        {
          nombre: "Ramo Girasoles y Rosas",
          imagen: "imagenes/ramo-4.jpg",
          descripcion:
            "Ramo de girasoles y rosas rojas, lleno de energía y frescura.",
          precio: "$70.000",
        },
        {
          nombre: "Manojo Variado rosado",
          imagen: "imagenes/manojo-5.jpeg",
          descripcion: "Manojo de margaritas, fresco y juvenil.",
          precio: "$25.000",
        },
        {
          nombre: "Ramo Variado",
          imagen: "imagenes/ramo-6.jpg",
          descripcion:
            "Ramo de girasoles y flores silvestres, natural y encantador.",
          precio: "$80.000",
        },
        {
          nombre: "Manojo De Girasoles",
          imagen: "imagenes/manojo-3.jpeg",
          descripcion: "Manojo de girasoles, lleno de energía y alegría.",
          precio: "$40.000",
        },
        {
          nombre: "Ramo Variado",
          imagen: "imagenes/ramo-6.jpg",
          descripcion:
            "Ramo de girasoles y flores silvestres, natural y encantador.",
          precio: "$80.000",
        },
        {
          nombre: "Manojo Variado rosado",
          imagen: "imagenes/manojo-5.jpeg",
          descripcion: "Manojo de margaritas, fresco y juvenil.",
          precio: "$25.000",
        },
        {
          nombre: "Manojo Variado",
          imagen: "imagenes/manojo-2.jpeg",
          descripcion:
            "Manojo de Rosas variadas, ideal para expresar amor y pureza.",
          precio: "$30.000",
        },
        // Productos de temporada
        {
          nombre: "Ramo Rosas Rojas",
          imagen: "imagenes/ramo-1.jpeg",
          descripcion:
            "Un hermoso ramo de rosas rojas, perfecto para cualquier ocasión.",
          precio: "$80.000",
        },
        {
          nombre: "Jarron de rosas rojas",
          imagen: "imagenes/ramo-2.png",
          descripcion:
            "Ramo de tulipanes, perfecto para alegrar cualquier espacio.",
          precio: "$22.000",
        },
        {
          nombre: "Ramo variado",
          imagen: "imagenes/ramo-3.jpg",
          descripcion: "Ramo de liliums, elegante y sofisticado.",
          precio: "$24.000",
        },
        {
          nombre: "Ramo de girasoles y rosas",
          imagen: "imagenes/ramo-4.jpg",
          descripcion:
            "Ramo de girasoles y margaritas, lleno de energía y frescura.",
          precio: "$21.000",
        },
        //Productos Reciente
        {
          nombre: "Ramo de rosas variadas",
          imagen: "imagenes/Ramo9.jpeg",
          descripcion: "Un ramo con una mezcla de rosas para ocasiones especiales.",
          precio: "$75.000",
        },
        {
          nombre: "Ramo de girasoles",
          imagen: "imagenes/Ramo10.jpeg",
          descripcion: "Ramo vibrante con girasoles frescos.",
          precio: "$65.000",
        },
        {
          nombre: "Manojo variado",
          imagen: "imagenes/Manojo10.jpeg",
          descripcion: "Manojo de flores variadas, ideal para decoración.",
          precio: "$55.000",
        },
        {
          nombre: "Manojo variado clásico",
          imagen: "imagenes/Manojo11.jpeg",
          descripcion: "Manojo de flores clásicas para un toque elegante.",
          precio: "$60.000",
        },
      ];

      const productos = [
        {
          id: "ramo-1",
          nombre: "Ramo de Rosas",
          imagen: "imagenes/ramo-1.jpeg",
        },
        {
          id: "ramo-2",
          nombre: "Ramo de Tulipanes",
          imagen: "imagenes/ramo-2.png",
        },
        {
          id: "ramo-3",
          nombre: "Ramo de Lirios",
          imagen: "imagenes/ramo-3.jpg",
        },
        { id: "ramo-4", nombre: "Ramo Mixto", imagen: "imagenes/ramo-4.jpg" },
        {
          id: "ramo-5",
          nombre: "Ramo de Margaritas",
          imagen: "imagenes/ramo-5.jpg",
        },
        {
          id: "ramo-6",
          nombre: "Ramo de Girasoles",
          imagen: "imagenes/ramo-6.jpg",
        },
        {
          id: "ramo-7",
          nombre: "Ramo de Claveles",
          imagen: "imagenes/ramo-7.jpg",
        },
        {
          id: "ramo-8",
          nombre: "Ramo de Peonias",
          imagen: "imagenes/ramo-8.jpg",
        },
        {
          id: "Ramo9",
          nombre: "Ramo de rosas variadas",
          imagen: "imagenes/ramo9.jpeg",
        },
        {
          id: "Ramo10",
          nombre: "Ramo de girasoles",
          imagen: "imagenes/ramo10.jpeg",
        },
        {
          id: "manojo-1",
          nombre: "Manojo de Lavanda",
          imagen: "imagenes/manojo-1.jpeg",
        },
        {
          id: "manojo-2",
          nombre: "Manojo de Romero",
          imagen: "imagenes/manojo-2.jpeg",
        },
        {
          id: "manojo-3",
          nombre: "Manojo de Eucalipto",
          imagen: "imagenes/manojo-3.jpeg",
        },
        {
          id: "manojo-4",
          nombre: "Manojo de Hierbabuena",
          imagen: "imagenes/manojo-4.jpeg",
        },
        {
          id: "manojo-5",
          nombre: "Manojo de Albahaca",
          imagen: "imagenes/manojo-5.jpeg",
        },
        {
          id: "manojo-6",
          nombre: "Manojo de Cilantro",
          imagen: "imagenes/manojo-6.jpeg",
        },
        {
          id: "manojo-7",
          nombre: "Manojo de Tomillo",
          imagen: "imagenes/manojo-7.jpg",
        },
        {
          id: "manojo-8",
          nombre: "Manojo de Menta",
          imagen: "imagenes/manojo-8.jpg",
        },
        {
          id: "Manojo10",
          nombre: "Manojo variado",
          imagen: "imagenes/Manojo10.jpeg",
        },
        {
          id: "Manojo11",
          nombre: "Manojo variado clásico",
          imagen: "imagenes/Manojo11.jpeg",
        },
      ];

      //Nombre en blur
      document.querySelectorAll(".flor-clickeable").forEach((flor) => {
        const img = flor.querySelector("img");
        const imgSrc = img.getAttribute("src");
        const florData = datosFlores.find(item => item.imagen === imgSrc);

        if (florData) {
          const contenedorInfo = document.createElement("div");
          contenedorInfo.className = "nombre-flor";

          const nombreElement = document.createElement("div");
          nombreElement.className = "nombre-flor-texto";
          nombreElement.textContent = florData.nombre;

          const precioElement = document.createElement("div");
          precioElement.className = "precio-flor-texto";
          precioElement.textContent = florData.precio;

          contenedorInfo.appendChild(nombreElement);
          contenedorInfo.appendChild(precioElement);
          flor.appendChild(contenedorInfo);
        }
      });

      // -------------------- MODAL --------------------
      const modal = document.getElementById("modal");
      const modalTitulo = document.getElementById("modal-titulo");
      const modalImagen = document.getElementById("modal-imagen");
      const modalDescripcion = document.getElementById("modal-descripcion");
      const modalPrecio = document.getElementById("modal-precio");
      const cerrarModal = document.querySelector(".cerrar-modal");
      let currentFlowerIndex = 0;

      document.querySelectorAll(".flor-clickeable").forEach((flor, index) => {
        flor.addEventListener("click", () => {
          const imgSrc = flor.querySelector("img").getAttribute("src");
          const producto = datosFlores.find((item) => item.imagen === imgSrc);

          if (producto) {
            currentFlowerIndex = datosFlores.indexOf(producto);
            abrirModal(producto);
          }
        });
      });

      function abrirModal(producto) {
        const productoExacto = datosFlores.find(f => f.imagen === producto.imagen);
        if (productoExacto) {
          modalTitulo.textContent = productoExacto.nombre;
          modalImagen.src = productoExacto.imagen;
          modalDescripcion.textContent = productoExacto.descripcion;
          modalPrecio.textContent = `Precio: ${productoExacto.precio}`;
          modal.style.display = 'flex';
        }
      }

      cerrarModal.addEventListener("click", () => modal.style.display = "none");
      window.addEventListener("click", (e) => e.target === modal && (modal.style.display = "none"));

      // -------------------- BÚSQUEDA --------------------
      const searchInput = document.getElementById("search-input");
      const searchResults = document.getElementById("search-results");

      searchInput.addEventListener("input", function () {
        const query = this.value.trim().toLowerCase();
        searchResults.innerHTML = "";

        if (query) {
          const filtrados = productos
            .filter(
              (p) =>
                p.nombre.toLowerCase().includes(query) ||
                p.id.toLowerCase().includes(query)
            )
            .map((p) => ({
              ...p,
              data: datosFlores.find((f) => f.imagen === p.imagen),
            }));

          mostrarResultados(filtrados);
        } else {
          searchResults.style.display = "none";
        }
      });

      function mostrarResultados(resultados) {
        searchResults.innerHTML = resultados
          .map(
            (p) => `
            <div class="resultado-busqueda">
                <img src="${p.imagen}" alt="${p.nombre}" width="40">
                <span>${p.nombre}</span>
            </div>
        `
          )
          .join("");

        searchResults.style.display = resultados.length ? "block" : "none";
        searchResults
          .querySelectorAll(".resultado-busqueda")
          .forEach((item, i) => {
            item.addEventListener("click", () =>
              abrirModal(resultados[i].data)
            );
          });
      }
      // -------------------- CARRITO --------------------
      let carrito = JSON.parse(localStorage.getItem("carrito")) || [];
      const cartButton = document.querySelector(".cart-button");
      const carritoModal = document.getElementById("carrito-modal");
      const cerrarCarrito = document.querySelector(".cerrar-carrito");
      const vaciarCarritoBtn = document.getElementById("vaciar-carrito");

      function actualizarCarrito() {
        const carritoItems = document.getElementById("carrito-items");
        const carritoTotal = document.getElementById("carrito-total");
        let total = 0;

        carritoItems.innerHTML = carrito
          .map((item, index) => {
            const precio = parseInt(item.precio.replace(/\D/g, "")) || 0;
            const accesorioPrecio =
              {
                ninguno: 0,
                oso: 10000,
                globo: 5000,
                chocolate: 7000,
                corona: 8000,
              }[item.accesorio] || 0;

            const subtotal = (precio + accesorioPrecio) * item.cantidad;
            total += subtotal;

            return `
        <div class="carrito-item">
          <img src="${item.imagen}" alt="${item.nombre}">
          <div>
            <h3>${item.nombre}</h3>
            <p>Cantidad: ${item.cantidad}</p>
            ${item.mensaje ? `<p>Mensaje: ${item.mensaje}</p>` : ""}
            ${item.accesorio !== "ninguno"
                ? `<p>Accesorio: ${item.accesorio}</p>`
                : ""
              }
            <p>Subtotal: $${subtotal.toLocaleString()}</p>
            <button class="eliminar-item" data-index="${index}">Eliminar</button>
          </div>
        </div>
      `;
          })
          .join("");

        carritoTotal.textContent = total.toLocaleString();
        localStorage.setItem("carrito", JSON.stringify(carrito));
        cartButton.setAttribute("data-count", carrito.length);
        cartButton.style.backgroundColor =
          carrito.length > 0 ? "#8cbaa3" : "#a8d5ba";
      }

      // Eventos del carrito
      cartButton.addEventListener("click", () => {
        carritoModal.style.display = "block";
        actualizarCarrito();
      });

      cerrarCarrito.addEventListener(
        "click",
        () => (carritoModal.style.display = "none")
      );
      document.addEventListener("click", (e) => {
        if (e.target.classList.contains("eliminar-item")) {
          carrito.splice(e.target.dataset.index, 1);
          actualizarCarrito();
        }
      });
      vaciarCarritoBtn.addEventListener("click", () => {
        carrito = [];
        actualizarCarrito();
      });

      document
        .getElementById("agregar-carrito")
        .addEventListener("click", () => {
          const nuevoItem = {
            ...datosFlores[currentFlowerIndex],
            cantidad: parseInt(document.getElementById("cantidad").value),
            mensaje: document.getElementById("mensaje-flor").value,
            accesorio: document.getElementById("accesorios").value,
          };

          carrito.push(nuevoItem);
          document.getElementById("confirmacion-agregado").style.display =
            "block";
          setTimeout(
            () =>
            (document.getElementById(
              "confirmacion-agregado"
            ).style.display = "none"),
            2000
          );
          actualizarCarrito();
          modal.style.display = "none";
        });
      actualizarCarrito();

      //-----------------LOGIN-----------------------
      const loginButton = document.querySelector(".login-button");
      const loginModal = document.getElementById("login-modal");
      const cerrarLogin = document.querySelector(".cerrar-login");

      // Abrir modal
      loginButton.addEventListener("click", () => {
        loginModal.style.display = "flex";
      });

      // Cerrar modal
      cerrarLogin.addEventListener("click", () => {
        loginModal.style.display = "none";
      });

      // Cerrar al hacer clic fuera
      window.addEventListener("click", (e) => {
        if (e.target === loginModal) {
          loginModal.style.display = "none";
        }
      });

     document.getElementById("login-form").addEventListener("submit", async (e) => {
    e.preventDefault();
    
    const datosLogin = new URLSearchParams({
        correo: document.getElementById('correo').value,
        password: document.getElementById('password').value
    });

    try {
        const resp = await fetch('php/login.php', {
            method: 'POST',
            headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
            body: datosLogin
        });
        
        const data = await resp.json(); // Parse directo a JSON
        
        if (!data.success) {
            throw new Error(data.error || "Error en la autenticación");
        }

        sessionStorage.setItem('user_role', data.role);
        actualizarNav();
        window.location.href = data.redirect;

    } catch (err) {
        console.error('Error:', err);
        alert(err.message || "Error de conexión");
        window.location.reload();
    }
});
      // Manejo de pestañas
      document.querySelectorAll('.tab-link').forEach(button => {
        button.addEventListener('click', () => {
          const tab = button.dataset.tab;

          // Remover clases activas
          document.querySelectorAll('.tab-link, .tab-content').forEach(el => {
            el.classList.remove('active');
          });

          // Activar elementos correspondientes
          button.classList.add('active');
          document.getElementById(tab).classList.add('active');
        });
      });

      // Manejar envío de formulario de registro
      document.getElementById("registro-form").addEventListener("submit", async (e) => {
        e.preventDefault();

        // Construimos los datos con los 'name' que espera el PHP
        const datosRegistro = new URLSearchParams({
            nombre: document.getElementById('reg-username').value,
            correo: document.getElementById('reg-email').value,  // Nombre correcto
            password: document.getElementById('reg-password').value
        });

        try {
          const resp = await fetch('php/registro_vendedor.php', {
            method: 'POST',
            body: datosRegistro
          });

          if (resp.ok) {
            const texto = await resp.text();
            console.log('Respuesta del servidor:', texto);
            alert('Registro exitoso');
            document.getElementById("registro-form").reset();
            loginModal.style.display = "none";
          } else {
            console.error('Error en respuesta:', resp.status, resp.statusText);
            alert('Hubo un problema al registrar. Intenta de nuevo.');
          }

        } catch (err) {
          console.error('Error de red:', err);
          alert('No se pudo conectar con el servidor.');
        }
      });
    });



 //-----------------CONDICIONAL DE ROL PARA LOGIN-----------------------

    const dynamicNavItem = document.getElementById('dynamic-nav-item');
    const navLink = document.getElementById('nav-link');

    function actualizarNav() {
        const userRole = sessionStorage.getItem('user_role');
        const dynamicNavItem = document.getElementById('dynamic-nav-item');
        const navLink = document.getElementById('nav-link');

        if (userRole) {
            dynamicNavItem.style.display = 'block';
            navLink.textContent = userRole === 'seller' ? 'Modo Vendedor' : 'Pedidos Anteriores';
            navLink.href = userRole === 'seller' ? 'vendedor.html' : 'pedidos-anteriores.html';
        } else {
            dynamicNavItem.style.display = 'none';
        }
    }

    // Llamar al cargar y después de login
    document.addEventListener("DOMContentLoaded", actualizarNav);

  </script>
</body>

</html>
